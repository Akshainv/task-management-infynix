<!-- employee-dashboard.component.html -->
<app-employee-sidebar></app-employee-sidebar>

<div class="main-content">
  <div class="dashboard-container">

    <!-- Summary Cards Section -->
    <section class="summary-cards-section">
      <div class="summary-cards-grid">
        <div *ngFor="let card of summaryCards" class="summary-card" [style.background]="card.bgColor"
          (click)="onCardClick(card.route)" [style.cursor]="card.route ? 'pointer' : 'default'">

          <div class="summary-card-glow"></div>

          <div class="card-content">
            <div class="card-icon" [style.background]="card.iconBg">
              <i class="fas" [ngClass]="card.icon" [style.color]="card.accentColor"></i>
            </div>

            <div class="card-info">
              <h3 class="card-title">{{ card.title }}</h3>
              <p class="card-value" [style.color]="card.accentColor">{{ card.value }}</p>
            </div>
          </div>

          <div class="card-footer">
            <span class="card-trend">
              <i class="fas fa-arrow-up"></i>
              {{ card.description }}
            </span>
          </div>
        </div>
      </div>
    </section>

    <!-- Attendance Section -->
    <section class="attendance-section">
      <div class="attendance-container">

        <!-- Attendance Header -->
        <div class="attendance-header">
          <div class="header-left">
            <i class="fas fa-clock header-icon"></i>
            <h2 class="section-title">Daily Attendance</h2>
          </div>
          <div class="current-status" [ngClass]="getStatusClass()">
            <i class="fas fa-circle status-indicator"></i>
            <span>{{ getCurrentStatus() }}</span>
          </div>
        </div>

        <!-- Attendance Content -->
        <div class="attendance-content">

          <!-- Instructions -->
          <div class="attendance-instructions">
            <p class="instruction-text">
              <i class="fas fa-info-circle"></i>
              {{ attendanceStatus.isCheckedIn ? 'Clock out when you finish your workday' : 'Click Clock In to start your workday' }}
            </p>
          </div>

          <!-- Photo Display Section (Always visible after photo is taken) -->
          <div class="photo-section" *ngIf="photoPreview">
            <h3 class="photo-title">
              <i class="fas fa-camera"></i>
              Attendance Photo
            </h3>

            <div class="photo-display-area">
              <div class="photo-display-container">
                <img [src]="photoPreview" alt="Attendance Photo" class="attendance-photo">
                <button type="button" 
                        class="remove-photo-btn" 
                        (click)="removePhoto()" 
                        title="Remove photo and reset attendance">
                  <i class="fas fa-times"></i>
                </button>
              </div>
              <p class="photo-status">
                <i class="fas fa-check-circle"></i>
                Photo captured successfully
              </p>
            </div>
          </div>

          <!-- Clock In/Out Action Button -->
          <div class="action-buttons">
            <!-- Clock In Button (Show only when NOT checked in) -->
            <button type="button" 
                    class="clock-in-btn"
                    *ngIf="!attendanceStatus.isCheckedIn"
                    (click)="checkIn()">
              <i class="fas fa-sign-in-alt"></i>
              <span>CLOCK IN</span>
            </button>

            <!-- Clock Out Button (Show only when checked in and NOT checked out) -->
            <button type="button" 
                    class="clock-out-btn"
                    *ngIf="attendanceStatus.isCheckedIn && !attendanceStatus.checkOutTime"
                    (click)="checkOut()">
              <i class="fas fa-sign-out-alt"></i>
              <span>CLOCK OUT</span>
            </button>

            <!-- Completion Message (Show after clocked out) -->
            <div class="completion-message" *ngIf="attendanceStatus.checkOutTime">
              <i class="fas fa-check-double"></i>
              <span>Attendance marked for today. Have a great day!</span>
            </div>
          </div>

          <!-- Attendance Times Display -->
          <div class="attendance-times" *ngIf="attendanceStatus.checkInTime">
            <div class="time-entry">
              <div class="time-icon-wrapper check-in-icon">
                <i class="fas fa-sign-in-alt"></i>
              </div>
              <div class="time-details">
                <span class="time-label">Clock In Time</span>
                <span class="time-value">{{ attendanceStatus.checkInTime }}</span>
              </div>
            </div>
            <div class="time-entry" *ngIf="attendanceStatus.checkOutTime">
              <div class="time-icon-wrapper check-out-icon">
                <i class="fas fa-sign-out-alt"></i>
              </div>
              <div class="time-details">
                <span class="time-label">Clock Out Time</span>
                <span class="time-value">{{ attendanceStatus.checkOutTime }}</span>
              </div>
            </div>
          </div>

        </div>

      </div>
    </section>

  </div>
</div>

<!-- Camera/Upload Modal -->
<div class="camera-modal" *ngIf="showCameraModal">
  <div class="camera-modal-overlay" (click)="closeCamera()"></div>
  <div class="camera-modal-content">
    <div class="camera-modal-header">
      <h3>
        <i class="fas fa-camera"></i>
        Capture Attendance Photo
      </h3>
      <button type="button" class="close-modal-btn" (click)="closeCamera()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div class="camera-modal-body">
      <video id="cameraVideo" autoplay playsinline></video>
    </div>
    <div class="camera-modal-footer">
      <button type="button" class="capture-btn" (click)="capturePhoto()">
        <i class="fas fa-camera"></i>
        Capture Photo
      </button>
      <button type="button" class="upload-file-btn" (click)="triggerFileInput()">
        <i class="fas fa-upload"></i>
        Upload File
      </button>
      <button type="button" class="cancel-btn" (click)="closeCamera()">
        <i class="fas fa-times"></i>
        Cancel
      </button>
    </div>
  </div>
</div>

<!-- Hidden file input -->
<input type="file" 
       id="photoUpload" 
       accept="image/*" 
       (change)="onFileSelected($event)"
       style="display: none;">